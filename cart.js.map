{"version":3,"file":"cart.js","sources":["../src/cart.js"],"sourcesContent":["//Логіка сторінки Cart\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { LS } from './js/storage';\nimport { refs } from './js/refs';\nimport { handlers } from './js/handlers';\nimport { getProduct } from './js/products-api';\nimport {\n  renderProducts,\n  updateHeader,\n  updateOrderSummary,\n} from './js/render-function';\n\n// dummyjson like data for renderProducts\n\nconst cart = LS.getKeys().filter(product => product.qty);\n\nasync function initCart() {\n  const data = {\n    total: 0,\n    sum: 0,\n  };\n  updateHeader();\n  data.products = await cartProducts();\n  data.total = data.products.length;\n  data.sum = data.products.reduce((total, product) => total + product.price, 0);\n  updateOrderSummary(data.total, data.sum.toFixed(2));\n  renderProducts(data, 1);\n}\n\nasync function cartProducts() {\n  const productPromises = cart.map(product => getProduct(product.productId));\n\n  try {\n    const cartProducts = await Promise.all(productPromises);\n    return cartProducts;\n  } catch (error) {\n    console.error(error);\n    return [];\n  }\n}\n\nexport function cartProcessing() {\n  iziToast.info({\n    message: `Successful purchase of products`,\n    position: 'bottomCenter',\n    timeout: 2000,\n  });\n\n  // cleaning LS products qty\n  cart.forEach(product => {\n    LS.add(product.productId, product.wish, 0);\n  });\n}\n\nrefs.orderSummary\n  .querySelector('.cart-summary__btn')\n  .addEventListener('click', cartProcessing);\nrefs.products.addEventListener('click', handlers.productCard);\nrefs.searchForm.addEventListener('submit', handlers.searchProduct);\nrefs.searchForm.addEventListener('click', handlers.searchClear);\nwindow.addEventListener(`DOMContentLoaded`, initCart);\n"],"names":["cart","LS","product","initCart","data","updateHeader","cartProducts","total","updateOrderSummary","renderProducts","productPromises","getProduct","error","cartProcessing","iziToast","refs","handlers"],"mappings":"4IAgBA,MAAMA,EAAOC,EAAG,QAAS,EAAC,OAAOC,GAAWA,EAAQ,GAAG,EAEvD,eAAeC,GAAW,CACxB,MAAMC,EAAO,CACX,MAAO,EACP,IAAK,CACT,EACEC,IACAD,EAAK,SAAW,MAAME,IACtBF,EAAK,MAAQA,EAAK,SAAS,OAC3BA,EAAK,IAAMA,EAAK,SAAS,OAAO,CAACG,EAAOL,IAAYK,EAAQL,EAAQ,MAAO,CAAC,EAC5EM,EAAmBJ,EAAK,MAAOA,EAAK,IAAI,QAAQ,CAAC,CAAC,EAClDK,EAAeL,EAAM,CAAC,CACxB,CAEA,eAAeE,GAAe,CAC5B,MAAMI,EAAkBV,EAAK,IAAIE,GAAWS,EAAWT,EAAQ,SAAS,CAAC,EAEzE,GAAI,CAEF,OADqB,MAAM,QAAQ,IAAIQ,CAAe,CAEvD,OAAQE,EAAO,CACd,eAAQ,MAAMA,CAAK,EACZ,EACR,CACH,CAEO,SAASC,GAAiB,CAC/BC,EAAS,KAAK,CACZ,QAAS,kCACT,SAAU,eACV,QAAS,GACb,CAAG,EAGDd,EAAK,QAAQE,GAAW,CACtBD,EAAG,IAAIC,EAAQ,UAAWA,EAAQ,KAAM,CAAC,CAC7C,CAAG,CACH,CAEAa,EAAK,aACF,cAAc,oBAAoB,EAClC,iBAAiB,QAASF,CAAc,EAC3CE,EAAK,SAAS,iBAAiB,QAASC,EAAS,WAAW,EAC5DD,EAAK,WAAW,iBAAiB,SAAUC,EAAS,aAAa,EACjED,EAAK,WAAW,iBAAiB,QAASC,EAAS,WAAW,EAC9D,OAAO,iBAAiB,mBAAoBb,CAAQ"}